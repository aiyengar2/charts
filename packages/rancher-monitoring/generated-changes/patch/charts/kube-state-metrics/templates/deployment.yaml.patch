--- charts-original/charts/kube-state-metrics/templates/deployment.yaml
+++ charts/charts/kube-state-metrics/templates/deployment.yaml
@@ -44,6 +44,7 @@
         fsGroup: {{ .Values.securityContext.fsGroup }}
         runAsGroup: {{ .Values.securityContext.runAsGroup }}
         runAsUser: {{ .Values.securityContext.runAsUser }}
+        runAsNonRoot: {{ .Values.securityContext.runAsNonRoot }}
       {{- end }}
     {{- if .Values.priorityClassName }}
       priorityClassName: {{ .Values.priorityClassName }}
@@ -154,7 +155,7 @@
         - --pod-namespace=$(POD_NAMESPACE)
 {{ end }}
         imagePullPolicy: {{ .Values.image.pullPolicy }}
-        image: "{{ .Values.image.repository }}:{{ .Values.image.tag }}"
+        image: "{{ template "system_default_registry" . }}{{ .Values.image.repository }}:{{ .Values.image.tag }}"
         ports:
         - containerPort: 8080
         livenessProbe:
@@ -181,11 +182,11 @@
       affinity:
 {{ toYaml .Values.affinity | indent 8 }}
 {{- end }}
+      nodeSelector: {{ include "linux-node-selector" . | nindent 8 }}
 {{- if .Values.nodeSelector }}
-      nodeSelector:
 {{ toYaml .Values.nodeSelector | indent 8 }}
 {{- end }}
+      tolerations: {{ include "linux-node-tolerations" . | nindent 8 }}
 {{- if .Values.tolerations }}
-      tolerations:
 {{ toYaml .Values.tolerations | indent 8 }}
 {{- end }}
