--- charts-original/templates/deployment.yaml
+++ charts/templates/deployment.yaml
@@ -45,6 +45,7 @@
         fsGroup: {{ .Values.securityContext.fsGroup }}
         runAsGroup: {{ .Values.securityContext.runAsGroup }}
         runAsUser: {{ .Values.securityContext.runAsUser }}
+        runAsNonRoot: {{ .Values.securityContext.runAsNonRoot }}
       {{- end }}
     {{- if .Values.priorityClassName }}
       priorityClassName: {{ .Values.priorityClassName }}
@@ -69,91 +70,91 @@
         {{- end  }}
 {{  end  }}
 {{  if .Values.collectors.certificatesigningrequests  }}
-        - --collectors=certificatesigningrequests
+        - --resources=certificatesigningrequests
 {{  end  }}
 {{  if .Values.collectors.configmaps  }}
-        - --collectors=configmaps
+        - --resources=configmaps
 {{  end  }}
 {{  if .Values.collectors.cronjobs  }}
-        - --collectors=cronjobs
+        - --resources=cronjobs
 {{  end  }}
 {{ if .Values.collectors.daemonsets  }}
-        - --collectors=daemonsets
+        - --resources=daemonsets
 {{  end  }}
 {{  if .Values.collectors.deployments  }}
-        - --collectors=deployments
+        - --resources=deployments
 {{  end  }}
 {{  if .Values.collectors.endpoints  }}
-        - --collectors=endpoints
+        - --resources=endpoints
 {{  end  }}
 {{  if .Values.collectors.horizontalpodautoscalers  }}
-        - --collectors=horizontalpodautoscalers
+        - --resources=horizontalpodautoscalers
 {{  end  }}
 {{  if .Values.collectors.ingresses  }}
-        - --collectors=ingresses
+        - --resources=ingresses
 {{  end  }}
 {{  if .Values.collectors.jobs  }}
-        - --collectors=jobs
+        - --resources=jobs
 {{  end  }}
 {{  if .Values.collectors.limitranges  }}
-        - --collectors=limitranges
+        - --resources=limitranges
 {{  end  }}
 {{  if .Values.collectors.mutatingwebhookconfigurations  }}
-        - --collectors=mutatingwebhookconfigurations
+        - --resources=mutatingwebhookconfigurations
 {{  end  }}
 {{  if .Values.collectors.namespaces  }}
-        - --collectors=namespaces
+        - --resources=namespaces
 {{  end  }}
 {{  if .Values.collectors.networkpolicies  }}
-        - --collectors=networkpolicies
+        - --resources=networkpolicies
 {{  end  }}
 {{  if .Values.collectors.nodes  }}
-        - --collectors=nodes
+        - --resources=nodes
 {{  end  }}
 {{  if .Values.collectors.persistentvolumeclaims  }}
-        - --collectors=persistentvolumeclaims
+        - --resources=persistentvolumeclaims
 {{  end  }}
 {{  if .Values.collectors.persistentvolumes  }}
-        - --collectors=persistentvolumes
+        - --resources=persistentvolumes
 {{  end  }}
 {{  if .Values.collectors.poddisruptionbudgets  }}
-        - --collectors=poddisruptionbudgets
+        - --resources=poddisruptionbudgets
 {{  end  }}
 {{  if .Values.collectors.pods  }}
-        - --collectors=pods
+        - --resources=pods
 {{  end  }}
 {{  if .Values.collectors.replicasets  }}
-        - --collectors=replicasets
+        - --resources=replicasets
 {{  end  }}
 {{  if .Values.collectors.replicationcontrollers  }}
-        - --collectors=replicationcontrollers
+        - --resources=replicationcontrollers
 {{  end  }}
 {{  if .Values.collectors.resourcequotas  }}
-        - --collectors=resourcequotas
+        - --resources=resourcequotas
 {{  end  }}
 {{  if .Values.collectors.secrets  }}
-        - --collectors=secrets
+        - --resources=secrets
 {{  end  }}
 {{  if .Values.collectors.services  }}
-        - --collectors=services
+        - --resources=services
 {{  end  }}
 {{  if .Values.collectors.statefulsets  }}
-        - --collectors=statefulsets
+        - --resources=statefulsets
 {{  end  }}
 {{  if .Values.collectors.storageclasses  }}
-        - --collectors=storageclasses
+        - --resources=storageclasses
 {{  end  }}
 {{  if .Values.collectors.validatingwebhookconfigurations  }}
-        - --collectors=validatingwebhookconfigurations
+        - --resources=validatingwebhookconfigurations
 {{  end  }}
 {{  if .Values.collectors.verticalpodautoscalers  }}
-        - --collectors=verticalpodautoscalers
+        - --resources=verticalpodautoscalers
 {{  end  }}
 {{  if .Values.collectors.volumeattachments  }}
-        - --collectors=volumeattachments
+        - --resources=volumeattachments
 {{  end  }}
-{{ if .Values.namespace }}
-        - --namespace={{ .Values.namespace | join "," }}
+{{ if .Values.namespaces }}
+        - --namespaces={{ tpl .Values.namespaces $ | join "," }}
 {{ end }}
 {{ if .Values.autosharding.enabled }}
         - --pod=$(POD_NAME)
@@ -173,9 +174,12 @@
           readOnly: true
 {{- end }}
         imagePullPolicy: {{ .Values.image.pullPolicy }}
-        image: "{{ .Values.image.repository }}:{{ .Values.image.tag }}"
+        image: "{{ template "system_default_registry" . }}{{ .Values.image.repository }}:{{ .Values.image.tag }}"
         ports:
         - containerPort: 8080
+{{- if .Values.selfMonitor.enabled }}
+        - containerPort: 8081
+{{- end }}
         livenessProbe:
           httpGet:
             path: /healthz
@@ -192,6 +196,10 @@
         resources:
 {{ toYaml .Values.resources | indent 10 }}
 {{- end }}
+{{- if .Values.containerSecurityContext }}
+        securityContext:
+{{ toYaml .Values.containerSecurityContext | indent 10 }}
+{{- end }}
 {{- if .Values.imagePullSecrets }}
       imagePullSecrets:
 {{ toYaml .Values.imagePullSecrets | indent 8 }}
@@ -200,12 +208,12 @@
       affinity:
 {{ toYaml .Values.affinity | indent 8 }}
 {{- end }}
+      nodeSelector: {{ include "linux-node-selector" . | nindent 8 }}
 {{- if .Values.nodeSelector }}
-      nodeSelector:
 {{ toYaml .Values.nodeSelector | indent 8 }}
 {{- end }}
+      tolerations: {{ include "linux-node-tolerations" . | nindent 8 }}
 {{- if .Values.tolerations }}
-      tolerations:
 {{ toYaml .Values.tolerations | indent 8 }}
 {{- end }}
 {{- if .Values.kubeconfig.enabled}}
